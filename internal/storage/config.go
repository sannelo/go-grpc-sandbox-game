package storage

import (
	"time"
)

// Конфигурационные параметры пакета storage.
// При необходимости их можно переопределить до инициализации хранилища,
// например, в функции main() либо в тестах.

var (
	// MaxOpenRegions определяет, сколько файлов регионов может быть открыто одновременно.
	// Чем выше значение, тем меньше операций открытия/закрытия файлов, но выше потребление ресурсов.
	MaxOpenRegions = 16

	// MaxDeltaCacheSize ограничивает объём in-memory кеша дельт (ChunkDelta).
	// При превышении порога наиболее «старыe» дельты выгружаются из памяти.
	MaxDeltaCacheSize = 500

	// RegionCompactionInterval задаёт периодическую частоту проверки файлов регионов
	// на необходимость компактации. Чем меньше интервал — тем чаще будут проходить
	// операции Compact(), но тем выше нагрузка на диск.
	RegionCompactionInterval = 30 * time.Minute

	// RegionCompactionGrowFactor — во сколько раз текущий размер файла может
	// превышать «живой» объём данных (заголовок + индекс + реальные дельты) прежде,
	// чем будет запущена Compact(). Значение 1.5 означает: если файл более чем на
	// 50 % больше полезных данных, запускаем копирование.
	RegionCompactionGrowFactor = 1.5

	// DeltaCacheCleanupBatch задаёт количество «чистых» (непомеченных dirty) дельт,
	// которые будут вычищаться из памяти за один проход cleanupWorker().
	DeltaCacheCleanupBatch = 50
)
